

\usepackage{pgfplots}
\usepackage{pgfplotstable}
\usepackage{filecontents}
\usepackage{calc}
\usepackage{ifthen}

\tikzstyle{every picture}+=[remember picture]
\tikzstyle{na} = [baseline=-.5ex]

\newcommand{\experimentmarkscaleone}{0.75}
\newcommand{\experimentmarkscaletwo}{0.75}
\newcommand{\experimentmarkscalethree}{1.0}
\newcommand{\experimentmarkscalefour}{0.75}
\newcommand{\experimentmarkscalefive}{0.75}
\newcommand{\experimentxaxispertick}{10}

\newcommand{\getlength}[1][]{\strip@pt#1}

\newcommand{\experimentfindmax}[1][]{
  \pgfplotstablevertcat{\concatenated}{#1}%
  \pgfplotstablesort[sort key={1},sort cmp={float >}]{\sorted}{\concatenated}%
  \pgfplotstablegetelem{0}{1}\of{\sorted}%
  \let\experimentmaxvalue=\pgfplotsretval%
}

\newcommand{\experimentfindmin}[1][]{
  \pgfplotstablevertcat{\concatenated}{#1}%
  \pgfplotstablesort[sort key={1},sort cmp={float <}]{\sorted}{\concatenated}%
  \pgfplotstablegetelem{0}{1}\of{\sorted}%
  \let\experimentminvalue=\pgfplotsretval%
}

% #1 - max x
% #2 - max y

\newcommand{\experimentaxes}[2][]{
  %axes
  \draw (0,0) -- coordinate (x axis mid) (#1,0);
  \draw (0,0) -- coordinate (y axis mid) (0,#2);
  
  % x ticks
  \ifthenelse{\lengthtest{0.125 pt > #1 pt}}{
    {\foreach \x in {0,0.05,...,#1}
      \draw (\x,1pt) -- (\x,-3pt)
      node[anchor=north] {\x};
    }
  }{
    \ifthenelse{\lengthtest{0.25 pt > #1 pt}}{
      {\foreach \x in {0,0.1,...,#1}
        \draw (\x,1pt) -- (\x,-3pt)
        node[anchor=north] {\x};
      }
    }{
      \ifthenelse{\lengthtest{1 pt > #1 pt}}{
        {\foreach \x in {0,0.25,...,#1}
          \draw (\x,1pt) -- (\x,-3pt)
          node[anchor=north] {\x};
        }
      }{
        \ifthenelse{\lengthtest{2.5 pt > #1 pt}}{
          {\foreach \x in {0,0.5,...,#1}
            \draw (\x,1pt) -- (\x,-3pt)
            node[anchor=north] {\x};
          }
        }{
          \ifthenelse{\lengthtest{10 pt > #1 pt}}{
            {\foreach \x in {0,2.5,...,#1}
              \draw (\x,1pt) -- (\x,-3pt)
              node[anchor=north] {\x};
            }
          }{
            \ifthenelse{\lengthtest{25 pt > #1 pt}}{
              {\foreach \x in {0,5,...,#1}
                \draw (\x,1pt) -- (\x,-3pt)
                node[anchor=north] {\x};
              }
            }{
              \ifthenelse{\lengthtest{100 pt > #1 pt}}{
                {\foreach \x in {0,15,...,#1}
                  \draw (\x,1pt) -- (\x,-3pt)
                  node[anchor=north] {\x};
                }
              }{
                \ifthenelse{\lengthtest{250 pt > #1 pt}}{
                  {\foreach \x in {0,30,...,#1}
                    \draw (\x,1pt) -- (\x,-3pt)
                    node[anchor=north] {\x};
                  }
                }{
                  {\foreach \x in {0,60,...,#1}
                    \draw (\x,1pt) -- (\x,-3pt)
                    node[anchor=north] {\x};
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  \draw (#1,1pt) -- (#1,0pt)
    node[anchor=north] {};
  % y ticks
  \ifthenelse{\lengthtest{0.125 pt > #2 pt}}{
    {\foreach \y in {0,0.05,...,#2}
      \ifthenelse{\lengthtest{\y pt > #2 pt}}{
      }{
        \draw (1pt,\y) -- (-3pt,\y) 
        node[anchor=east] {\y}; 
      };
    }
  }{
    \ifthenelse{\lengthtest{0.25 pt > #2 pt}}{
      {\foreach \y in {0,0.1,...,#2}
        \ifthenelse{\lengthtest{\y pt > #2 pt}}{
        }{
          \draw (1pt,\y) -- (-3pt,\y) 
          node[anchor=east] {\y}; 
        };
      }
    }{
      \ifthenelse{\lengthtest{1 pt > #2 pt}}{
        {\foreach \y in {0,0.25,...,#2}
          \ifthenelse{\lengthtest{\y pt > #2 pt}}{
          }{
            \draw (1pt,\y) -- (-3pt,\y) 
            node[anchor=east] {\y}; 
          };
        }
      }{
        \ifthenelse{\lengthtest{2.5 pt > #2 pt}}{
          {\foreach \y in {0,0.5,...,#2}
            \ifthenelse{\lengthtest{\y pt > #2 pt}}{
            }{
              \draw (1pt,\y) -- (-3pt,\y) 
              node[anchor=east] {\y}; 
            };
          }
        }{
          \ifthenelse{\lengthtest{10 pt > #2 pt}}{
            {\foreach \y in {0,2.5,...,#2}
              \ifthenelse{\lengthtest{\y pt > #2 pt}}{
              }{
                \draw (1pt,\y) -- (-3pt,\y) 
                node[anchor=east] {\y}; 
              };
            }
          }{
            \ifthenelse{\lengthtest{25 pt > #2 pt}}{
              {\foreach \y in {0,5,...,#2}
                \ifthenelse{\lengthtest{\y pt > #2 pt}}{
                }{
                  \draw (1pt,\y) -- (-3pt,\y) 
                  node[anchor=east] {\y}; 
                };
              }
            }{
              \ifthenelse{\lengthtest{100 pt > #2 pt}}{
                {\foreach \y in {0,25,...,#2}
                  \ifthenelse{\lengthtest{\y pt > #2 pt}}{
                  }{
                    \draw (1pt,\y) -- (-3pt,\y) 
                    node[anchor=east] {\y}; 
                  };
                }
              }{
                \ifthenelse{\lengthtest{250 pt > #2 pt}}{
                  {\foreach \y in {0,50,...,#2}
                    \ifthenelse{\lengthtest{\y pt > #2 pt}}{
                    }{
                      \draw (1pt,\y) -- (-3pt,\y) 
                      node[anchor=east] {\y}; 
                    };
                  }
                }{
                  {\foreach \y in {0,100,...,#2}
                    \ifthenelse{\lengthtest{\y pt > #2 pt}}{
                    }{
                      \draw (1pt,\y) -- (-3pt,\y) 
                      node[anchor=east] {\y}; 
                    };
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  %  \foreach \y in {0,#2,...,#2}
  %    \draw (1pt,\y) -- (-3pt,\y) 
  %    node[anchor=east] {\y}; 
  \draw (1pt,#2) -- (0pt,#2) 
  node[anchor=east] {}; 
}

\newcommand{\experimentdataone}[3][]{
  %plots
  \begin{scope}
    \clip (0,0) rectangle (#1 / 100 * 100,#2 / 100 * 103);
    
    \draw plot[mark=*, mark options={fill=white,scale=\experimentmarkscalefour}]
      file {#3};
  \end{scope}
}

\newcommand{\experimentdatatwo}[3][]{
  %plots
  \begin{scope}
    \clip (0,0) rectangle (#1 / 100 * 100,#2 / 100 * 103);
    
    \draw plot[mark=square*, mark options={fill=white,scale=\experimentmarkscaletwo}]
      file {#3};
  \end{scope}
}

\newcommand{\experimentdatathree}[3][]{
  %plots
  \begin{scope}
    \clip (0,0) rectangle (#1 / 100 * 100,#2 / 100 * 103);
    
    \draw plot[mark=triangle*, mark options={fill=white,scale=\experimentmarkscalethree}]
      file {#3};
  \end{scope}
}

\newcommand{\experimentdatafour}[3][]{
  %plots
  \begin{scope}
    \clip (0,0) rectangle (#1 / 100 * 100,#2 / 100 * 103);
    
    \draw plot[mark=square*, mark options={fill=black,scale=\experimentmarkscaleone}]
      file {#3};
  \end{scope}
}

\newcommand{\experimentdatafive}[3][]{
  %plots
  \begin{scope}
    \clip (0,0) rectangle (#1 / 100 * 100,#2 / 100 * 103);
    
    \draw plot[mark=triangle*, mark options={fill=black,scale=\experimentmarkscalefive}]
      file {#3};
  \end{scope}
}

\newcommand{\experimentlegendone}[3][]{
  %legend
  \begin{scope}[shift={(#1,#2)}]
    \draw (0,0) -- 
      plot[mark=*, mark options={fill=white,scale=\experimentmarkscalefour}] (0.25,0) -- (0.5,0) 
      node[right]{#3};
  \end{scope}
}

\newcommand{\experimentlegendtwo}[3][]{
  %legend
  \begin{scope}[shift={(#1,#2)}]
    \draw (0,0) -- 
      plot[mark=square*, mark options={fill=white,scale=\experimentmarkscaletwo}] (0.25,0) -- (0.5,0) 
      node[right]{#3};
  \end{scope}
}

\newcommand{\experimentlegendthree}[3][]{
  %legend
  \begin{scope}[shift={(#1,#2)}]
    \draw (0,0) -- 
      plot[mark=triangle*, mark options={fill=white,scale=\experimentmarkscalethree}] (0.25,0) -- (0.5,0) 
      node[right]{#3};
  \end{scope}
}

\newcommand{\experimentlegendfour}[3][]{
  %legend
  \begin{scope}[shift={(#1,#2)}]
    \draw (0,0) -- 
      plot[mark=square*, mark options={fill=black,scale=\experimentmarkscaleone}] (0.25,0) -- (0.5,0) 
      node[right]{#3};
  \end{scope}
}

\newcommand{\experimentlegendfive}[3][]{
  %legend
  \begin{scope}[shift={(#1,#2)}]
    \draw (0,0) -- 
      plot[mark=triangle*, mark options={fill=black,scale=\experimentmarkscalefive}] (0.25,0) -- (0.5,0) 
      node[right]{#3};
  \end{scope}
}

\newcommand{\experimentdatalegendone}[4][]{
  \experimentdataone[#1]{#2}{#3};
  \experimentlegendone[#1 * 1 / 10]{#2 * 11 / 10}{#4};
}

\newcommand{\experimentdatalegendtwo}[4][]{
  \experimentdatatwo[#1]{#2}{#3};
  \experimentlegendtwo[#1 * 1 / 10]{#2 * 11 / 10}{#4};
}

\newcommand{\experimentdatalegendthree}[4][]{
  \experimentdatathree[#1]{#2}{#3};
  \experimentlegendthree[#1 * 1 / 10]{#2 * 11 / 10}{#4};
}

\newcommand{\experimentdatalegendfour}[4][]{
  \experimentdatafour[#1]{#2}{#3};
  \experimentlegendfour[#1 * 1 / 10]{#2 * 11 / 10}{#4};
}

\newcommand{\experimentdatalegendfive}[4][]{
  \experimentdatafive[#1]{#2}{#3};
  \experimentlegendfive[#1 * 1 / 10]{#2 * 11 / 10}{#4};
}

\newcommand{\experimentxaxislabel}{
  \node[below=0.6cm] at (x axis mid) {Minutes};
}

\newcommand{\experimentxaxiscloselabel}{
  \node[below=0.5cm] at (x axis mid) {Minutes};
}

\newcommand{\experimentyaxisbytecodes}{
  \node[rotate=90, above=1.4cm] at (y axis mid) {Thousands of};
  \node[rotate=90, above=0.8cm] at (y axis mid) {Bytecodes/s};
  %\node[rotate=90, above=0.8cm] at (y axis mid) {Thousands of Bytecodes/s};
}

\newcommand{\experimentyaxisbytes}{
  \node[rotate=90, above=0.8cm] at (y axis mid) {Millions of Bytes/s};
}

\newcommand{\experimentyaxismemory}{
  \node[rotate=90, above=0.8cm] at (y axis mid) {Millions of Bytes};
}


% bytecode rate, memory allocation, garbage collection, memory usage triple plots

\newcommand{\causegroupplotsexecution}[9]{
  \begingroup%
  \def\causegroupplotsexecutionplotmaxtime{#1}%
  \def\causegroupplotsexecutionexperimentonemaxtime{#2}%
  \def\causegroupplotsexecutionexperimenttwomaxtime{#3}%
  \def\causegroupplotsexecutionexperimentthreemaxtime{#4}%
  \def\causegroupplotsexecutionexperimentonename{#5}%
  \def\causegroupplotsexecutionexperimenttwoname{#6}%
  \def\causegroupplotsexecutionexperimentthreename{#7}%
  \def\causegroupplotsexecutioncausegroupfilenameroot{#8}%
  \def\causegroupplotsexecutionlegendlabel{#9}%
  \experimentfindmax[data/\causegroupplotsexecutionexperimentonename/\causegroupplotsexecutioncausegroupfilenameroot-bytecode_count.data]
  \let\causegroupplotsexecutionexperimentonemaxvalue\experimentmaxvalue%
  \experimentfindmax[data/\causegroupplotsexecutionexperimenttwoname/\causegroupplotsexecutioncausegroupfilenameroot-bytecode_count.data]
  \let\causegroupplotsexecutionexperimenttwomaxvalue\experimentmaxvalue%
  \experimentfindmax[data/\causegroupplotsexecutionexperimentthreename/\causegroupplotsexecutioncausegroupfilenameroot-bytecode_count.data]
  \let\causegroupplotsexecutionexperimentthreemaxvalue\experimentmaxvalue%
  \ifthenelse{\lengthtest{\causegroupplotsexecutionexperimentonemaxvalue pt > \causegroupplotsexecutionexperimenttwomaxvalue pt}}{
    \ifthenelse{\lengthtest{\causegroupplotsexecutionexperimentonemaxvalue pt > \causegroupplotsexecutionexperimentthreemaxvalue pt}}{
      \let\causegroupplotsexecutionexperimentmaxvalue\causegroupplotsexecutionexperimentonemaxvalue%
    }{
      \let\causegroupplotsexecutionexperimentmaxvalue\causegroupplotsexecutionexperimentthreemaxvalue%
    }
  }{
    \ifthenelse{\lengthtest{\causegroupplotsexecutionexperimenttwomaxvalue pt > \causegroupplotsexecutionexperimentthreemaxvalue pt}}{
      \let\causegroupplotsexecutionexperimentmaxvalue\causegroupplotsexecutionexperimenttwomaxvalue%
    }{
      \let\causegroupplotsexecutionexperimentmaxvalue\causegroupplotsexecutionexperimentthreemaxvalue%
    }
  }
  \ifthenelse{\lengthtest{0.01 pt > \causegroupplotsexecutionexperimentmaxvalue pt}}{
  }{
    \begin{tikzpicture}[y=6cm/\causegroupplotsexecutionexperimentmaxvalue, x=8cm/\causegroupplotsexecutionplotmaxtime,font=\sffamily]
      \experimentaxes[\causegroupplotsexecutionplotmaxtime]{\causegroupplotsexecutionexperimentmaxvalue}
      
      %labels
      \experimentxaxislabel
      \experimentyaxisbytecodes
      
      \experimentdataone[\causegroupplotsexecutionplotmaxtime]{\causegroupplotsexecutionexperimentmaxvalue}{data/\causegroupplotsexecutionexperimentonename/\causegroupplotsexecutioncausegroupfilenameroot-bytecode_count.data};
      \experimentdatatwo[\causegroupplotsexecutionplotmaxtime]{\causegroupplotsexecutionexperimentmaxvalue}{data/\causegroupplotsexecutionexperimenttwoname/\causegroupplotsexecutioncausegroupfilenameroot-bytecode_count.data};
      \experimentdatathree[\causegroupplotsexecutionplotmaxtime]{\causegroupplotsexecutionexperimentmaxvalue}{data/\causegroupplotsexecutionexperimentthreename/\causegroupplotsexecutioncausegroupfilenameroot-bytecode_count.data};
    \end{tikzpicture}
  }
  \endgroup%
}

\newcommand{\causegroupplotsallocation}[9]{
  \begingroup%
  \def\causegroupplotsallocationplotmaxtime{#1}%
  \def\causegroupplotsallocationexperimentonemaxtime{#2}%
  \def\causegroupplotsallocationexperimenttwomaxtime{#3}%
  \def\causegroupplotsallocationexperimentthreemaxtime{#4}%
  \def\causegroupplotsallocationexperimentonename{#5}%
  \def\causegroupplotsallocationexperimenttwoname{#6}%
  \def\causegroupplotsallocationexperimentthreename{#7}%
  \def\causegroupplotsallocationcausegroupfilenameroot{#8}%
  \def\causegroupplotsallocationlegendlabel{#9}%
  \experimentfindmax[data/\causegroupplotsallocationexperimentonename/\causegroupplotsallocationcausegroupfilenameroot-bytes_allocated_count.data]
  \let\causegroupplotsallocationexperimentonemaxvalue\experimentmaxvalue%
  \experimentfindmax[data/\causegroupplotsallocationexperimenttwoname/\causegroupplotsallocationcausegroupfilenameroot-bytes_allocated_count.data]
  \let\causegroupplotsallocationexperimenttwomaxvalue\experimentmaxvalue%
  \experimentfindmax[data/\causegroupplotsallocationexperimentthreename/\causegroupplotsallocationcausegroupfilenameroot-bytes_allocated_count.data]
  \let\causegroupplotsallocationexperimentthreemaxvalue\experimentmaxvalue%
  \ifthenelse{\lengthtest{\causegroupplotsallocationexperimentonemaxvalue pt > \causegroupplotsallocationexperimenttwomaxvalue pt}}{
    \ifthenelse{\lengthtest{\causegroupplotsallocationexperimentonemaxvalue pt > \causegroupplotsallocationexperimentthreemaxvalue pt}}{
      \let\causegroupplotsallocationexperimentmaxvalue\causegroupplotsallocationexperimentonemaxvalue%
    }{
      \let\causegroupplotsallocationexperimentmaxvalue\causegroupplotsallocationexperimentthreemaxvalue%
    }
  }{
    \ifthenelse{\lengthtest{\causegroupplotsallocationexperimenttwomaxvalue pt > \causegroupplotsallocationexperimentthreemaxvalue pt}}{
      \let\causegroupplotsallocationexperimentmaxvalue\causegroupplotsallocationexperimenttwomaxvalue%
    }{
      \let\causegroupplotsallocationexperimentmaxvalue\causegroupplotsallocationexperimentthreemaxvalue%
    }
  }
  \ifthenelse{\lengthtest{0.01 pt > \causegroupplotsallocationexperimentmaxvalue pt}}{
  }{
    \begin{tikzpicture}[y=6cm/\causegroupplotsallocationexperimentmaxvalue, x=8cm/\causegroupplotsallocationplotmaxtime,font=\sffamily]
      \experimentaxes[\causegroupplotsallocationplotmaxtime]{\causegroupplotsallocationexperimentmaxvalue}
      
      %labels
      \experimentxaxislabel
      \experimentyaxisbytes
      
      \experimentdataone[\causegroupplotsallocationplotmaxtime]{\causegroupplotsallocationexperimentmaxvalue}{data/\causegroupplotsallocationexperimentonename/\causegroupplotsallocationcausegroupfilenameroot-bytes_allocated_count.data};
      \experimentdatatwo[\causegroupplotsallocationplotmaxtime]{\causegroupplotsallocationexperimentmaxvalue}{data/\causegroupplotsallocationexperimenttwoname/\causegroupplotsallocationcausegroupfilenameroot-bytes_allocated_count.data};
      \experimentdatathree[\causegroupplotsallocationplotmaxtime]{\causegroupplotsallocationexperimentmaxvalue}{data/\causegroupplotsallocationexperimentthreename/\causegroupplotsallocationcausegroupfilenameroot-bytes_allocated_count.data};
    \end{tikzpicture}
  }
  \endgroup%
}

\newcommand{\causegroupplotscollection}[9]{
  \begingroup%
  \def\causegroupplotscollectionplotmaxtime{#1}%
  \def\causegroupplotscollectionexperimentonemaxtime{#2}%
  \def\causegroupplotscollectionexperimenttwomaxtime{#3}%
  \def\causegroupplotscollectionexperimentthreemaxtime{#4}%
  \def\causegroupplotscollectionexperimentonename{#5}%
  \def\causegroupplotscollectionexperimenttwoname{#6}%
  \def\causegroupplotscollectionexperimentthreename{#7}%
  \def\causegroupplotscollectioncausegroupfilenameroot{#8}%
  \def\causegroupplotscollectionlegendlabel{#9}%
  \experimentfindmax[data/\causegroupplotscollectionexperimentonename/\causegroupplotscollectioncausegroupfilenameroot-bytes_freed_count.data]
  \let\causegroupplotscollectionexperimentonemaxvalue\experimentmaxvalue%
  \experimentfindmax[data/\causegroupplotscollectionexperimenttwoname/\causegroupplotscollectioncausegroupfilenameroot-bytes_freed_count.data]
  \let\causegroupplotscollectionexperimenttwomaxvalue\experimentmaxvalue%
  \experimentfindmax[data/\causegroupplotscollectionexperimentthreename/\causegroupplotscollectioncausegroupfilenameroot-bytes_freed_count.data]
  \let\causegroupplotscollectionexperimentthreemaxvalue\experimentmaxvalue%
  \ifthenelse{\lengthtest{\causegroupplotscollectionexperimentonemaxvalue pt > \causegroupplotscollectionexperimenttwomaxvalue pt}}{
    \ifthenelse{\lengthtest{\causegroupplotscollectionexperimentonemaxvalue pt > \causegroupplotscollectionexperimentthreemaxvalue pt}}{
      \let\causegroupplotscollectionexperimentmaxvalue\causegroupplotscollectionexperimentonemaxvalue%
    }{
      \let\causegroupplotscollectionexperimentmaxvalue\causegroupplotscollectionexperimentthreemaxvalue%
    }
  }{
    \ifthenelse{\lengthtest{\causegroupplotscollectionexperimenttwomaxvalue pt > \causegroupplotscollectionexperimentthreemaxvalue pt}}{
      \let\causegroupplotscollectionexperimentmaxvalue\causegroupplotscollectionexperimenttwomaxvalue%
    }{
      \let\causegroupplotscollectionexperimentmaxvalue\causegroupplotscollectionexperimentthreemaxvalue%
    }
  }
  \ifthenelse{\lengthtest{0.01 pt > \causegroupplotscollectionexperimentmaxvalue pt}}{
  }{
    \begin{tikzpicture}[y=6cm/\causegroupplotscollectionexperimentmaxvalue, x=8cm/\causegroupplotscollectionplotmaxtime,font=\sffamily]
      \experimentaxes[\causegroupplotscollectionplotmaxtime]{\causegroupplotscollectionexperimentmaxvalue}
      
      %labels
      \experimentxaxislabel
      \experimentyaxisbytes
      
      \experimentdataone[\causegroupplotscollectionplotmaxtime]{\causegroupplotscollectionexperimentmaxvalue}{data/\causegroupplotscollectionexperimentonename/\causegroupplotscollectioncausegroupfilenameroot-bytes_freed_count.data};
      \experimentdatatwo[\causegroupplotscollectionplotmaxtime]{\causegroupplotscollectionexperimentmaxvalue}{data/\causegroupplotscollectionexperimenttwoname/\causegroupplotscollectioncausegroupfilenameroot-bytes_freed_count.data};
      \experimentdatathree[\causegroupplotscollectionplotmaxtime]{\causegroupplotscollectionexperimentmaxvalue}{data/\causegroupplotscollectionexperimentthreename/\causegroupplotscollectioncausegroupfilenameroot-bytes_freed_count.data};
    \end{tikzpicture}
  }
  \endgroup%
}

\newcommand{\causegroupplotsmemory}[9]{
  \begingroup%
  \def\causegroupplotsmemoryplotmaxtime{#1}%
  \def\causegroupplotsmemoryexperimentonemaxtime{#2}%
  \def\causegroupplotsmemoryexperimenttwomaxtime{#3}%
  \def\causegroupplotsmemoryexperimentthreemaxtime{#4}%
  \def\causegroupplotsmemoryexperimentonename{#5}%
  \def\causegroupplotsmemoryexperimenttwoname{#6}%
  \def\causegroupplotsmemoryexperimentthreename{#7}%
  \def\causegroupplotsmemorycausegroupfilenameroot{#8}%
  \def\causegroupplotsmemorylegendlabel{#9}%
  \experimentfindmax[data/\causegroupplotsmemoryexperimentonename/\causegroupplotsmemorycausegroupfilenameroot-bytes_footprint.data]
  \let\causegroupplotsmemoryexperimentonemaxvalue\experimentmaxvalue%
  \experimentfindmax[data/\causegroupplotsmemoryexperimenttwoname/\causegroupplotsmemorycausegroupfilenameroot-bytes_footprint.data]
  \let\causegroupplotsmemoryexperimenttwomaxvalue\experimentmaxvalue%
  \experimentfindmax[data/\causegroupplotsmemoryexperimentthreename/\causegroupplotsmemorycausegroupfilenameroot-bytes_footprint.data]
  \let\causegroupplotsmemoryexperimentthreemaxvalue\experimentmaxvalue%
  \ifthenelse{\lengthtest{\causegroupplotsmemoryexperimentonemaxvalue pt > \causegroupplotsmemoryexperimenttwomaxvalue pt}}{
    \ifthenelse{\lengthtest{\causegroupplotsmemoryexperimentonemaxvalue pt > \causegroupplotsmemoryexperimentthreemaxvalue pt}}{
      \let\causegroupplotsmemoryexperimentmaxvalue\causegroupplotsmemoryexperimentonemaxvalue%
    }{
      \let\causegroupplotsmemoryexperimentmaxvalue\causegroupplotsmemoryexperimentthreemaxvalue%
    }
  }{
    \ifthenelse{\lengthtest{\causegroupplotsmemoryexperimenttwomaxvalue pt > \causegroupplotsmemoryexperimentthreemaxvalue pt}}{
      \let\causegroupplotsmemoryexperimentmaxvalue\causegroupplotsmemoryexperimenttwomaxvalue%
    }{
      \let\causegroupplotsmemoryexperimentmaxvalue\causegroupplotsmemoryexperimentthreemaxvalue%
    }
  }
  \ifthenelse{\lengthtest{0.01 pt > \causegroupplotsmemoryexperimentmaxvalue pt}}{
  }{
    \begin{tikzpicture}[y=6cm/\causegroupplotsmemoryexperimentmaxvalue, x=8cm/\causegroupplotsmemoryplotmaxtime,font=\sffamily]
      \experimentaxes[\causegroupplotsmemoryplotmaxtime]{\causegroupplotsmemoryexperimentmaxvalue}
      
      %labels
      \experimentxaxislabel
      \experimentyaxismemory
      
      \experimentdataone[\causegroupplotsmemoryplotmaxtime]{\causegroupplotsmemoryexperimentmaxvalue}{data/\causegroupplotsmemoryexperimentonename/\causegroupplotsmemorycausegroupfilenameroot-bytes_footprint.data};
      \experimentdatatwo[\causegroupplotsmemoryplotmaxtime]{\causegroupplotsmemoryexperimentmaxvalue}{data/\causegroupplotsmemoryexperimenttwoname/\causegroupplotsmemorycausegroupfilenameroot-bytes_footprint.data};
      \experimentdatathree[\causegroupplotsmemoryplotmaxtime]{\causegroupplotsmemoryexperimentmaxvalue}{data/\causegroupplotsmemoryexperimentthreename/\causegroupplotsmemorycausegroupfilenameroot-bytes_footprint.data};
    \end{tikzpicture}
  }
  \endgroup%
}

\newcommand{\causegroupplots}[4]{
  \begin{tabular}{r}
    {\raggedleft
      #1
    }\\
    {\raggedleft
      #2
    }\\
    {\raggedleft
      #3
    }\\
    {\raggedleft
      #4
    }\\
  \end{tabular}
}


\newcommand\experimentcausegroupplots[9]{%
  \begingroup%
  \def\experimentcausegroupplotsplotmaxtime{#1}%
  \def\experimentcausegroupplotsexperimentonemaxtime{#2}%
  \def\experimentcausegroupplotsexperimenttwomaxtime{#3}%
  \def\experimentcausegroupplotsexperimentthreemaxtime{#4}%
  \def\experimentcausegroupplotsexperimentonename{#5}%
  \def\experimentcausegroupplotsexperimenttwoname{#6}%
  \def\experimentcausegroupplotsexperimentthreename{#7}%
  \def\experimentcausegroupplotsexperimentoneprettyname{#8}%
  \def\experimentcausegroupplotsexperimenttwoprettyname{#9}%
}
\newcommand\experimentcausegroupplotscontinued[4]{%
  \def\experimentcausegroupplotsexperimentthreeprettyname{#1}%
  \def\experimentcausegroupplotscausegroupfilenameroot{#2}%
  \def\experimentcausegroupplotscausegroupprettyname{#3}%
  \def\experimentdescription{#4}%
  \begin{figure}[ht]
    {\causegroupplots{\causegroupplotsexecution{\experimentcausegroupplotsplotmaxtime}
                                               {\experimentcausegroupplotsexperimentonemaxtime}
                                               {\experimentcausegroupplotsexperimenttwomaxtime}
                                               {\experimentcausegroupplotsexperimentthreemaxtime}
                                               {\experimentcausegroupplotsexperimentonename}
                                               {\experimentcausegroupplotsexperimenttwoname}
                                               {\experimentcausegroupplotsexperimentthreename}
                                               {\experimentcausegroupplotscausegroupfilenameroot}
                                               {Execution in {\experimentcausegroupplotscausegroupprettyname}}}
                     {%\causegroupplotsallocation{\experimentcausegroupplotsplotmaxtime}
                      %                          {\experimentcausegroupplotsexperimentonemaxtime}
                      %                          {\experimentcausegroupplotsexperimenttwomaxtime}
                      %                          {\experimentcausegroupplotsexperimentthreemaxtime}
                      %                          {\experimentcausegroupplotsexperimentonename}
                      %                          {\experimentcausegroupplotsexperimenttwoname}
                      %                          {\experimentcausegroupplotsexperimentthreename}
                      %                          {\experimentcausegroupplotscausegroupfilenameroot}
                      %                          {Allocation in {\experimentcausegroupplotscausegroupprettyname}}
                      }
                     {%\causegroupplotscollection{\experimentcausegroupplotsplotmaxtime}
                      %                          {\experimentcausegroupplotsexperimentonemaxtime}
                      %                          {\experimentcausegroupplotsexperimenttwomaxtime}
                      %                          {\experimentcausegroupplotsexperimentthreemaxtime}
                      %                          {\experimentcausegroupplotsexperimentonename}
                      %                          {\experimentcausegroupplotsexperimenttwoname}
                      %                          {\experimentcausegroupplotsexperimentthreename}
                      %                          {\experimentcausegroupplotscausegroupfilenameroot}
                      %                          {Collection in {\experimentcausegroupplotscausegroupprettyname}}
                      }
                     {\causegroupplotsmemory{\experimentcausegroupplotsplotmaxtime}
                                            {\experimentcausegroupplotsexperimentonemaxtime}
                                            {\experimentcausegroupplotsexperimenttwomaxtime}
                                            {\experimentcausegroupplotsexperimentthreemaxtime}
                                            {\experimentcausegroupplotsexperimentonename}
                                            {\experimentcausegroupplotsexperimenttwoname}
                                            {\experimentcausegroupplotsexperimentthreename}
                                            {\experimentcausegroupplotscausegroupfilenameroot}
                                            {Memory Used in {\experimentcausegroupplotscausegroupprettyname}}}}
    \caption[] {Total rate of bytecode execution, rate of memory
      allocation, garbage collection and overall memory usage in {\experimentcausegroupplotscausegroupprettyname}
      during {\experimentdescription}}
    \label{figure:\experimentcausegroupplotscausegroupfilenameroot}
  \end{figure}%
  \endgroup%
}


\newcommand{\experimentdatatable}[3][]{
  \begin{table}
    \centering
    \begin{tabular}{lllrr}
      ~         & \emph{Layer}      & \emph{Agency}      & \emph{Experiment Data}                                                              & Page \\
      \hline AI &                   &                    & \autoref{figure:data/#1/mind_plot-Gripper-1}                                        & \pageref{figure:data/#1/mind_plot-Gripper-1} \\
      ~         & Reflective        &                    & \autoref{figure:data/#1/mind_plot-Gripper-1-reflective}                             & \pageref{figure:data/#1/mind_plot-Gripper-1-reflective} \\
      ~         &                   & Event Knowledge    & \autoref{figure:data/#1/mind_plot-Gripper-1-reflective-reflective_event_knowledge}  & \pageref{figure:data/#1/mind_plot-Gripper-1-reflective-reflective_event_knowledge} \\
      ~         &                   & Execution          & \autoref{figure:data/#1/mind_plot-Gripper-1-reflective-execution}                   & \pageref{figure:data/#1/mind_plot-Gripper-1-reflective-execution} \\
      ~         &                   & Imagination        & \autoref{figure:data/#1/mind_plot-Gripper-1-reflective-imagination}                 & \pageref{figure:data/#1/mind_plot-Gripper-1-reflective-imagination} \\
      ~         &                   & Object Type Goal   & \autoref{figure:data/#1/mind_plot-Gripper-1-reflective-plan_object_type_goal}       & \pageref{figure:data/#1/mind_plot-Gripper-1-reflective-plan_object_type_goal} \\
      ~         &                   & Plan               & \autoref{figure:data/#1/mind_plot-Gripper-1-reflective-plan}                        & \pageref{figure:data/#1/mind_plot-Gripper-1-reflective-plan} \\
      ~         &                   & Plan Bug Response  & \autoref{figure:data/#1/mind_plot-Gripper-1-reflective-plan_bug_response}           & \pageref{figure:data/#1/mind_plot-Gripper-1-reflective-plan_bug_response} \\
      ~         & Deliberative      &                    & \autoref{figure:data/#1/mind_plot-Gripper-1-deliberative}                           & \pageref{figure:data/#1/mind_plot-Gripper-1-deliberative} \\
      ~         &                   & Execution          & \autoref{figure:data/#1/mind_plot-Gripper-1-deliberative-execution}                 & \pageref{figure:data/#1/mind_plot-Gripper-1-deliberative-execution} \\
      ~         &                   & Imagination        & \autoref{figure:data/#1/mind_plot-Gripper-1-deliberative-imagination}               & \pageref{figure:data/#1/mind_plot-Gripper-1-deliberative-imagination} \\
      ~         &                   & Object Type Goal   & \autoref{figure:data/#1/mind_plot-Gripper-1-deliberative-physical_object_type_goal} & \pageref{figure:data/#1/mind_plot-Gripper-1-deliberative-physical_object_type_goal} \\
      ~         &                   & Plan               & \autoref{figure:data/#1/mind_plot-Gripper-1-deliberative-plan}                      & \pageref{figure:data/#1/mind_plot-Gripper-1-deliberative-plan} \\
      ~         & Learned Reactive  &                    & \autoref{figure:data/#1/mind_plot-Gripper-1-learned_reactive}                       & \pageref{figure:data/#1/mind_plot-Gripper-1-learned_reactive} \\
      ~         &                   & Physical Action    & \autoref{figure:data/#1/mind_plot-Gripper-1-learned_reactive-physical}              & \pageref{figure:data/#1/mind_plot-Gripper-1-learned_reactive-physical} \\
      ~         &                   & Physical Knowledge & \autoref{figure:data/#1/mind_plot-Gripper-1-learned_reactive-physical_knowledge}    & \pageref{figure:data/#1/mind_plot-Gripper-1-learned_reactive-physical_knowledge} \\
      ~         & Built-in Reactive &                    & \autoref{figure:data/#1/mind_plot-Gripper-1-builtin_reactive}                       & \pageref{figure:data/#1/mind_plot-Gripper-1-builtin_reactive} \\
      ~         &                   & Neural Plug        & \autoref{figure:data/#1/mind_plot-Gripper-1-builtin_reactive-neural_plug}           & \pageref{figure:data/#1/mind_plot-Gripper-1-builtin_reactive-neural_plug} \\
      ~         &                   & Physical Action    & \autoref{figure:data/#1/mind_plot-Gripper-1-builtin_reactive-physical}              & \pageref{figure:data/#1/mind_plot-Gripper-1-builtin_reactive-physical} \\
      ~         &                   & Sensory            & \autoref{figure:data/#1/mind_plot-Gripper-1-builtin_reactive-sensory}               & \pageref{figure:data/#1/mind_plot-Gripper-1-builtin_reactive-sensory} \\
    \end{tabular}
    \caption[Data from #2.]{Data from #2.  #3}
    \label{table:#1}
  \end{table}
}



\newcommand{\dataappendixmaxtime}{180}
\newcommand{\dataappendixexperimentonemaxtime}{60}
\newcommand{\dataappendixexperimenttwomaxtime}{75}
\newcommand{\dataappendixexperimentthreemaxtime}{180}
\newcommand{\dataappendixexperimentonename}{bootup}
\newcommand{\dataappendixexperimenttwoname}{no_reflective_learning}
\newcommand{\dataappendixexperimentthreename}{reflective_learning}
\newcommand{\dataappendixexperimentoneprettyname}{Bootup and Perceive}
\newcommand{\dataappendixexperimenttwoprettyname}{Deliberative Learning without Reflection}
\newcommand{\dataappendixexperimentthreeprettyname}{Deliberative and Reflective Learning}

